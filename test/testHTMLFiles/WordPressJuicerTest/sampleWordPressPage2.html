<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en"><!--<![endif]--><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<title>Constant initialization | Andrzej's C++ blog</title>
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="stylesheet" type="text/css" media="all" href="sampleWordPressPage2_files/style.css">
<link rel="pingback" href="http://akrzemi1.wordpress.com/xmlrpc.php">
<link rel="alternate" type="application/rss+xml" title="Andrzej's C++ blog » Feed" href="http://akrzemi1.wordpress.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Andrzej's C++ blog » Comments Feed" href="http://akrzemi1.wordpress.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Andrzej's C++ blog » Constant&nbsp;initialization Comments Feed" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/feed/">
<script type="text/javascript" async="" src="sampleWordPressPage2_files/quant.js"></script><script type="text/javascript">
/* <![CDATA[ */
function addLoadEvent(func){var oldonload=window.onload;if(typeof window.onload!='function'){window.onload=func;}else{window.onload=function(){oldonload();func();}}}
/* ]]> */
</script>
<link rel="stylesheet" id="all-css-0" href="sampleWordPressPage2_files/a.css" type="text/css" media="all">
<script type="text/javascript">
/* <![CDATA[ */
var LoggedOutFollow = {"invalid_email":"Your subscription did not succeed, please try again with a valid email address."};
/* ]]> */
</script>
<script type="text/javascript" src="sampleWordPressPage2_files/a_002.js"></script>
<link rel="stylesheet" id="all-css-0" href="sampleWordPressPage2_files/style_002.css" type="text/css" media="all">
<!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='http://s2.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563g&#038;ver=20110606' type='text/css' media='all' />
<![endif]-->
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://akrzemi1.wordpress.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://akrzemi1.wordpress.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Using PODs in&nbsp;C++11" href="http://akrzemi1.wordpress.com/2012/04/23/using-pods-in-c11/">
<link rel="next" title="Beware of magic&nbsp;values!" href="http://akrzemi1.wordpress.com/2012/06/19/beware-of-magic-values/">
<meta name="generator" content="WordPress.com">
<link rel="canonical" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/">
<link rel="shortlink" href="http://wp.me/p1tkks-MS">
<link rel="alternate" type="application/json+oembed" href="http://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=http%3A%2F%2Fakrzemi1.wordpress.com%2F2012%2F05%2F27%2Fconstant-initialization%2F&amp;for=wpcom-auto-discovery"><link rel="alternate" type="application/xml+oembed" href="http://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=http%3A%2F%2Fakrzemi1.wordpress.com%2F2012%2F05%2F27%2Fconstant-initialization%2F&amp;for=wpcom-auto-discovery">
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Constant&nbsp;initialization">
<meta property="og:url" content="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/">
<meta property="og:description" content="In one of my previous articles about compile-time computations we have seen how you can ‘abuse’ the new keyword constexpr in order to achieve some interesting effects. Now it is time to...">
<meta property="og:site_name" content="Andrzej's C++ blog">
<meta name="twitter:card" content="summary">
<meta property="fb:app_id" content="249643311490">
<link rel="shortcut icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311976022g" sizes="16x16 24x24 32x32 48x48">
<link rel="icon" type="image/x-icon" href="http://s2.wp.com/i/favicon.ico?m=1311976022g" sizes="16x16 24x24 32x32 48x48">
<link rel="apple-touch-icon-precomposed" href="http://s0.wp.com/i/webclip.png?m=1311618091g">
<link rel="openid.server" href="http://akrzemi1.wordpress.com/?openidserver=1">
<link rel="openid.delegate" href="http://akrzemi1.wordpress.com/">
<link rel="search" type="application/opensearchdescription+xml" href="http://akrzemi1.wordpress.com/osd.xml" title="Andrzej's C++ blog">
<link rel="search" type="application/opensearchdescription+xml" href="http://wordpress.com/opensearch.xml" title="WordPress.com">
		<style>
		/* <![CDATA[ */
		/* Block: reblog */
		
		.reblog-from img                   { margin: 0 10px 0 0; vertical-align: middle; padding: 0; border: 0; }
		.reblogger-note img.avatar         { float: left; padding: 0; border: 0; }
		.reblogger-note-content            { margin: 0 0 20px; }
		.reblog-post .wpcom-enhanced-excerpt-content { border-left: 3px solid #eee; padding-left: 15px; }
		.reblog-post ul.thumb-list         { display: block; list-style: none; margin: 2px 0; padding: 0; clear: both; }
		.reblog-post ul.thumb-list li      { display: inline; margin: 0; padding: 0 1px; border: 0; }
		.reblog-post ul.thumb-list li a    { margin: 0; padding: 0; border: 0; }
		.reblog-post ul.thumb-list li img  { margin: 0; padding: 0; border: 0; }
		
		.reblog-post .wpcom-enhanced-excerpt { clear: both; }
		
		.reblog-post .wpcom-enhanced-excerpt address,
		.reblog-post .wpcom-enhanced-excerpt li,
		.reblog-post .wpcom-enhanced-excerpt h1,
		.reblog-post .wpcom-enhanced-excerpt h2,
		.reblog-post .wpcom-enhanced-excerpt h3,
		.reblog-post .wpcom-enhanced-excerpt h4,
		.reblog-post .wpcom-enhanced-excerpt h5,
		.reblog-post .wpcom-enhanced-excerpt h6,
		.reblog-post .wpcom-enhanced-excerpt p { font-size: 100% !important; }
		
		.reblog-post .wpcom-enhanced-excerpt blockquote,
		.reblog-post .wpcom-enhanced-excerpt pre,
		.reblog-post .wpcom-enhanced-excerpt code,
		.reblog-post .wpcom-enhanced-excerpt q { font-size: 98% !important; }
		

		/* ]]> */		
		</style>
		<meta name="application-name" content="Andrzej's C++ blog"><meta name="msapplication-window" content="width=device-width;height=device-height"><meta name="msapplication-tooltip" content="Guidelines and thoughts about C++"><meta name="msapplication-task" content="name=Subscribe;action-uri=http://akrzemi1.wordpress.com/feed/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=http://s2.wp.com/i/favicon.ico"><meta name="title" content="Constant&nbsp;initialization | Andrzej's C++ blog on WordPress.com">
<meta name="description" content="In one of my previous articles about compile-time computations we have seen how you can ‘abuse’ the new keyword constexpr in order to achieve some interesting effects. Now it is time to show some of the intended usages of the … Continue reading →">

<script type="text/javascript" src="sampleWordPressPage2_files/google_service.js">
</script>
<script type="text/javascript">
GS_googleAddAdSenseService("ca-pub-3443918307802676");
GS_googleEnableAllServices();
</script>
<script type="text/javascript">
GA_googleAddSlot("ca-pub-3443918307802676", "wpcom_below_post_adsafe");
</script>
<script type="text/javascript">
GA_googleFetchAds();
</script>
<script type="text/javascript"> 
	window.google_analytics_uacct = "UA-52447-2"; 
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script><script src="sampleWordPressPage2_files/ga.js" async="" type="text/javascript"></script>
<script src="sampleWordPressPage2_files/rate.js" charset="utf-8"></script><link href="sampleWordPressPage2_files/shThemeDefault.css" type="text/css" rel="stylesheet"><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="sampleWordPressPage2_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="sampleWordPressPage2_files/services.css"><style id="pd_popup_holder_style_4527172_post_3030" type="text/css">#pd_popup_holder_4527172_post_3030 { position:absolute; display:none; width:350px; height:auto; top:0px; left:0px; z-index:10000; border:solid 1px #CCC; background-color:white; padding:0px 15px;font-family:Arial,Sans;box-shadow: -10px 10px 20px rgba(0, 0, 0, .5);-webkit-box-shadow: 0px 0px 6px rgba(0, 0, 0, .25);-moz-box-shadow: 0px 0px 6px rgba(0, 0, 0, .25); }</style><script type="text/javascript" src="sampleWordPressPage2_files/c3baf4aa5bebf6d1407ed4e3b0981864.json"></script><style type="text/css" charset="utf-8">/* See license.txt for terms of usage */
/** reset styling **/
.firebugResetStyles {
    z-index: 2147483646 !important;
    top: 0 !important;
    left: 0 !important;
    display: block !important;
    border: 0 none !important;
    margin: 0 !important;
    padding: 0 !important;
    outline: 0 !important;
    min-width: 0 !important;
    max-width: none !important;
    min-height: 0 !important;
    max-height: none !important;
    position: fixed !important;
    -moz-transform: rotate(0deg) !important;
    -moz-transform-origin: 50% 50% !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    background: transparent none !important;
    pointer-events: none !important;
}

.firebugBlockBackgroundColor {
    background-color: transparent !important;
}

.firebugResetStyles:before, .firebugResetStyles:after {
    content: "" !important;
}
/**actual styling to be modified by firebug theme**/
.firebugCanvas {
    display: none !important;
}

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
.firebugLayoutBox {
    width: auto !important;
    position: static !important;
}

.firebugLayoutBoxOffset {
    opacity: 0.8 !important;
    position: fixed !important;
}

.firebugLayoutLine {
    opacity: 0.4 !important;
    background-color: #000000 !important;
}

.firebugLayoutLineLeft, .firebugLayoutLineRight {
    width: 1px !important;
    height: 100% !important;
}

.firebugLayoutLineTop, .firebugLayoutLineBottom {
    width: 100% !important;
    height: 1px !important;
}

.firebugLayoutLineTop {
    margin-top: -1px !important;
    border-top: 1px solid #999999 !important;
}

.firebugLayoutLineRight {
    border-right: 1px solid #999999 !important;
}

.firebugLayoutLineBottom {
    border-bottom: 1px solid #999999 !important;
}

.firebugLayoutLineLeft {
    margin-left: -1px !important;
    border-left: 1px solid #999999 !important;
}

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
.firebugLayoutBoxParent {
    border-top: 0 none !important;
    border-right: 1px dashed #E00 !important;
    border-bottom: 1px dashed #E00 !important;
    border-left: 0 none !important;
    position: fixed !important;
    width: auto !important;
}

.firebugRuler{
    position: absolute !important;
}

.firebugRulerH {
    top: -15px !important;
    left: 0 !important;
    width: 100% !important;
    height: 14px !important;
    background: url("data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%13%88%00%00%00%0E%08%02%00%00%00L%25a%0A%00%00%00%04gAMA%00%00%D6%D8%D4OX2%00%00%00%19tEXtSoftware%00Adobe%20ImageReadyq%C9e%3C%00%00%04%F8IDATx%DA%EC%DD%D1n%E2%3A%00E%D1%80%F8%FF%EF%E2%AF2%95%D0D4%0E%C1%14%B0%8Fa-%E9%3E%CC%9C%87n%B9%81%A6W0%1C%A6i%9A%E7y%0As8%1CT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AATE9%FE%FCw%3E%9F%AF%2B%2F%BA%97%FDT%1D~K(%5C%9D%D5%EA%1B%5C%86%B5%A9%BDU%B5y%80%ED%AB*%03%FAV9%AB%E1%CEj%E7%82%EF%FB%18%BC%AEJ8%AB%FA'%D2%BEU9%D7U%ECc0%E1%A2r%5DynwVi%CFW%7F%BB%17%7Dy%EACU%CD%0E%F0%FA%3BX%FEbV%FEM%9B%2B%AD%BE%AA%E5%95v%AB%AA%E3E5%DCu%15rV9%07%B5%7F%B5w%FCm%BA%BE%AA%FBY%3D%14%F0%EE%C7%60%0EU%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5JU%88%D3%F5%1F%AE%DF%3B%1B%F2%3E%DAUCNa%F92%D02%AC%7Dm%F9%3A%D4%F2%8B6%AE*%BF%5C%C2Ym~9g5%D0Y%95%17%7C%C8c%B0%7C%18%26%9CU%CD%13i%F7%AA%90%B3Z%7D%95%B4%C7%60%E6E%B5%BC%05%B4%FBY%95U%9E%DB%FD%1C%FC%E0%9F%83%7F%BE%17%7DkjMU%E3%03%AC%7CWj%DF%83%9An%BCG%AE%F1%95%96yQ%0Dq%5Dy%00%3Et%B5'%FC6%5DS%95pV%95%01%81%FF'%07%00%00%00%00%00%00%00%00%00%F8x%C7%F0%BE%9COp%5D%C9%7C%AD%E7%E6%EBV%FB%1E%E0(%07%E5%AC%C6%3A%ABi%9C%8F%C6%0E9%AB%C0'%D2%8E%9F%F99%D0E%B5%99%14%F5%0D%CD%7F%24%C6%DEH%B8%E9rV%DFs%DB%D0%F7%00k%FE%1D%84%84%83J%B8%E3%BA%FB%EF%20%84%1C%D7%AD%B0%8E%D7U%C8Y%05%1E%D4t%EF%AD%95Q%BF8w%BF%E9%0A%BF%EB%03%00%00%00%00%00%00%00%00%00%B8vJ%8E%BB%F5%B1u%8Cx%80%E1o%5E%CA9%AB%CB%CB%8E%03%DF%1D%B7T%25%9C%D5(%EFJM8%AB%CC'%D2%B2*%A4s%E7c6%FB%3E%FA%A2%1E%80~%0E%3E%DA%10x%5D%95Uig%15u%15%ED%7C%14%B6%87%A1%3B%FCo8%A8%D8o%D3%ADO%01%EDx%83%1A~%1B%9FpP%A3%DC%C6'%9C%95gK%00%00%00%00%00%00%00%00%00%20%D9%C9%11%D0%C0%40%AF%3F%EE%EE%92%94%D6%16X%B5%BCMH%15%2F%BF%D4%A7%C87%F1%8E%F2%81%AE%AAvzr%DA2%ABV%17%7C%E63%83%E7I%DC%C6%0Bs%1B%EF6%1E%00%00%00%00%00%00%00%00%00%80cr%9CW%FF%7F%C6%01%0E%F1%CE%A5%84%B3%CA%BC%E0%CB%AA%84%CE%F9%BF)%EC%13%08WU%AE%AB%B1%AE%2BO%EC%8E%CBYe%FE%8CN%ABr%5Dy%60~%CFA%0D%F4%AE%D4%BE%C75%CA%EDVB%EA(%B7%F1%09g%E5%D9%12%00%00%00%00%00%00%00%00%00H%F6%EB%13S%E7y%5E%5E%FB%98%F0%22%D1%B2'%A7%F0%92%B1%BC%24z3%AC%7Dm%60%D5%92%B4%7CEUO%5E%F0%AA*%3BU%B9%AE%3E%A0j%94%07%A0%C7%A0%AB%FD%B5%3F%A0%F7%03T%3Dy%D7%F7%D6%D4%C0%AAU%D2%E6%DFt%3F%A8%CC%AA%F2%86%B9%D7%F5%1F%18%E6%01%F8%CC%D5%9E%F0%F3z%88%AA%90%EF%20%00%00%00%00%00%00%00%00%00%C0%A6%D3%EA%CFi%AFb%2C%7BB%0A%2B%C3%1A%D7%06V%D5%07%A8r%5D%3D%D9%A6%CAu%F5%25%CF%A2%99%97zNX%60%95%AB%5DUZ%D5%FBR%03%AB%1C%D4k%9F%3F%BB%5C%FF%81a%AE%AB'%7F%F3%EA%FE%F3z%94%AA%D8%DF%5B%01%00%00%00%00%00%00%00%00%00%8E%FB%F3%F2%B1%1B%8DWU%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*UiU%C7%BBe%E7%F3%B9%CB%AAJ%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5J%95*U%AAT%A9R%A5*%AAj%FD%C6%D4%5Eo%90%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5%86%AF%1B%9F%98%DA%EBm%BBV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%ADV%AB%D5j%B5Z%AD%D6%E4%F58%01%00%00%00%00%00%00%00%00%00%00%00%00%00%40%85%7F%02%0C%008%C2%D0H%16j%8FX%00%00%00%00IEND%AEB%60%82") repeat-x !important;
    border-top: 1px solid #BBBBBB !important;
    border-right: 1px dashed #BBBBBB !important;
    border-bottom: 1px solid #000000 !important;
}

.firebugRulerV {
    top: 0 !important;
    left: -15px !important;
    width: 14px !important;
    height: 100% !important;
    background: url("data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%0E%00%00%13%88%08%02%00%00%00%0E%F5%CB%10%00%00%00%04gAMA%00%00%D6%D8%D4OX2%00%00%00%19tEXtSoftware%00Adobe%20ImageReadyq%C9e%3C%00%00%06~IDATx%DA%EC%DD%D1v%A20%14%40Qt%F1%FF%FF%E4%97%D9%07%3BT%19%92%DC%40(%90%EEy%9A5%CB%B6%E8%F6%9Ac%A4%CC0%84%FF%DC%9E%CF%E7%E3%F1%88%DE4%F8%5D%C7%9F%2F%BA%DD%5E%7FI%7D%F18%DDn%BA%C5%FB%DF%97%BFk%F2%10%FF%FD%B4%F2M%A7%FB%FD%FD%B3%22%07p%8F%3F%AE%E3%F4S%8A%8F%40%EEq%9D%BE8D%F0%0EY%A1Uq%B7%EA%1F%81%88V%E8X%3F%B4%CEy%B7h%D1%A2E%EBohU%FC%D9%AF2fO%8BBeD%BE%F7X%0C%97%A4%D6b7%2Ck%A5%12%E3%9B%60v%B7r%C7%1AI%8C%BD%2B%23r%00c0%B2v%9B%AD%CA%26%0C%1Ek%05A%FD%93%D0%2B%A1u%8B%16-%95q%5Ce%DCSO%8E%E4M%23%8B%F7%C2%FE%40%BB%BD%8C%FC%8A%B5V%EBu%40%F9%3B%A72%FA%AE%8C%D4%01%CC%B5%DA%13%9CB%AB%E2I%18%24%B0n%A9%0CZ*Ce%9C%A22%8E%D8NJ%1E%EB%FF%8F%AE%CAP%19*%C3%BAEKe%AC%D1%AAX%8C*%DEH%8F%C5W%A1e%AD%D4%B7%5C%5B%19%C5%DB%0D%EF%9F%19%1D%7B%5E%86%BD%0C%95%A12%AC%5B*%83%96%CAP%19%F62T%86%CAP%19*%83%96%CA%B8Xe%BC%FE)T%19%A1%17xg%7F%DA%CBP%19*%C3%BA%A52T%86%CAP%19%F62T%86%CA%B0n%A9%0CZ%1DV%C6%3D%F3%FCH%DE%B4%B8~%7F%5CZc%F1%D6%1F%AF%84%F9%0F6%E6%EBVt9%0E~%BEr%AF%23%B0%97%A12T%86%CAP%19%B4T%86%CA%B8Re%D8%CBP%19*%C3%BA%A52huX%19%AE%CA%E5%BC%0C%7B%19*CeX%B7h%A9%0C%95%E1%BC%0C%7B%19*CeX%B7T%06%AD%CB%5E%95%2B%BF.%8F%C5%97%D5%E4%7B%EE%82%D6%FB%CF-%9C%FD%B9%CF%3By%7B%19%F62T%86%CA%B0n%D1R%19*%A3%D3%CA%B0%97%A12T%86uKe%D0%EA%B02*%3F1%99%5DB%2B%A4%B5%F8%3A%7C%BA%2B%8Co%7D%5C%EDe%A8%0C%95a%DDR%19%B4T%C66%82fA%B2%ED%DA%9FC%FC%17GZ%06%C9%E1%B3%E5%2C%1A%9FoiB%EB%96%CA%A0%D5qe4%7B%7D%FD%85%F7%5B%ED_%E0s%07%F0k%951%ECr%0D%B5C%D7-g%D1%A8%0C%EB%96%CA%A0%A52T%C6)*%C3%5E%86%CAP%19%D6-%95A%EB*%95q%F8%BB%E3%F9%AB%F6%E21%ACZ%B7%22%B7%9B%3F%02%85%CB%A2%5B%B7%BA%5E%B7%9C%97%E1%BC%0C%EB%16-%95%A12z%AC%0C%BFc%A22T%86uKe%D0%EA%B02V%DD%AD%8A%2B%8CWhe%5E%AF%CF%F5%3B%26%CE%CBh%5C%19%CE%CB%B0%F3%A4%095%A1%CAP%19*Ce%A8%0C%3BO*Ce%A8%0C%95%A12%3A%AD%8C%0A%82%7B%F0v%1F%2FD%A9%5B%9F%EE%EA%26%AF%03%CA%DF9%7B%19*Ce%A8%0C%95%A12T%86%CA%B8Ze%D8%CBP%19*Ce%A8%0C%95%D1ae%EC%F7%89I%E1%B4%D7M%D7P%8BjU%5C%BB%3E%F2%20%D8%CBP%19*Ce%A8%0C%95%A12T%C6%D5*%C3%5E%86%CAP%19*Ce%B4O%07%7B%F0W%7Bw%1C%7C%1A%8C%B3%3B%D1%EE%AA%5C%D6-%EBV%83%80%5E%D0%CA%10%5CU%2BD%E07YU%86%CAP%19*%E3%9A%95%91%D9%A0%C8%AD%5B%EDv%9E%82%FFKOee%E4%8FUe%A8%0C%95%A12T%C6%1F%A9%8C%C8%3D%5B%A5%15%FD%14%22r%E7B%9F%17l%F8%BF%ED%EAf%2B%7F%CF%ECe%D8%CBP%19*Ce%A8%0C%95%E1%93~%7B%19%F62T%86%CAP%19*Ce%A8%0C%E7%13%DA%CBP%19*Ce%A8%0CZf%8B%16-Z%B4h%D1R%19f%8B%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1%A2%A52%CC%16-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2EKe%98-Z%B4h%D1%A2EKe%D02%5B%B4h%D1%A2EKe%D02%5B%B4h%D1%A2E%8B%96%CA0%5B%B4h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%16-%95a%B6h%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-Z*%C3l%D1%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z%B4T%86%D9%A2E%8B%16-Z%B4T%06-%B3E%8B%16-Z%B4T%06-%B3E%8B%16-Z%B4h%A9%0C%B3E%8B%16-Z%B4h%A9%0CZf%8B%16-Z%B4h%A9%0CZf%8B%16-Z%B4h%D1R%19f%8B%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1%A2%A52%CC%16-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2EKe%98-Z%B4h%D1%A2EKe%D02%5B%B4h%D1%A2EKe%D02%5B%B4h%D1%A2E%8B%96%CA0%5B%B4h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%16-%95a%B6h%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-Z*%C3l%D1%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z%B4T%86%D9%A2E%8B%16-Z%B4T%06-%B3E%8B%16-Z%B4T%06-%B3E%8B%16-Z%B4h%A9%0C%B3E%8B%16-Z%B4h%A9%0CZf%8B%16-Z%B4h%A9%0CZf%8B%16-Z%B4h%D1R%19f%8B%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1R%19%B4%CC%16-Z%B4h%D1%A2%A52%CC%16-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2%A52h%99-Z%B4h%D1%A2EKe%98-Z%B4h%D1%A2EKe%D02%5B%B4h%D1%A2EKe%D02%5B%B4h%D1%A2E%8B%96%CA0%5B%B4h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%96%CA%A0e%B6h%D1%A2E%8B%16-%95a%B6h%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-%95A%CBl%D1%A2E%8B%16-Z*%C3l%D1%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z*%83%96%D9%A2E%8B%16-Z%B4T%86%D9%A2E%8B%16-Z%B4T%06-%B3E%8B%16-Z%B4%AE%A4%F5%25%C0%00%DE%BF%5C'%0F%DA%B8q%00%00%00%00IEND%AEB%60%82") repeat-y !important;
    border-left: 1px solid #BBBBBB !important;
    border-right: 1px solid #000000 !important;
    border-bottom: 1px dashed #BBBBBB !important;
}

.overflowRulerX > .firebugRulerV {
    left: 0 !important;
}

.overflowRulerY > .firebugRulerH {
    top: 0 !important;
}

/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
.fbProxyElement {
    position: fixed !important;
    pointer-events: auto !important;
}</style><script type="text/javascript" src="sampleWordPressPage2_files/37e370fb4e87500805abb44c8820ec1f.json"></script></head>

<body class="single single-post postid-3030 single-format-standard single-author highlander-enabled highlander-light">
<div id="wrapper" class="hfeed">
	<div id="header">
		<div id="masthead">
			<div id="branding" role="banner">
								<div id="site-title">
					<span>
						<a href="http://akrzemi1.wordpress.com/" title="Andrzej's C++ blog" rel="home">Andrzej's C++ blog</a>
					</span>
				</div>
				<div id="site-description">Guidelines and thoughts about C++</div>

										<a class="home-link" href="http://akrzemi1.wordpress.com/" title="Andrzej's C++ blog" rel="home">
							<img src="sampleWordPressPage2_files/cherryblossoms.jpg" alt="" height="198" width="940">
						</a>
								</div><!-- #branding -->

			<div id="access" role="navigation">
			  				<div class="skip-link screen-reader-text"><a href="#content" title="Skip to content">Skip to content</a></div>
								<div class="menu"><ul><li><a href="http://akrzemi1.wordpress.com/" title="Home">Home</a></li><li class="page_item page-item-2"><a href="http://akrzemi1.wordpress.com/about/">About</a></li></ul></div>
			</div><!-- #access -->
		</div><!-- #masthead -->
	</div><!-- #header -->

	<div id="main">

		<div id="container">
			<div id="content" role="main">

			

				<div id="nav-above" class="navigation">
					<div class="nav-previous"><a href="http://akrzemi1.wordpress.com/2012/04/23/using-pods-in-c11/" rel="prev"><span class="meta-nav">←</span> Using PODs in&nbsp;C++11</a></div>
					<div class="nav-next"><a href="http://akrzemi1.wordpress.com/2012/06/19/beware-of-magic-values/" rel="next">Beware of magic&nbsp;values! <span class="meta-nav">→</span></a></div>
				</div><!-- #nav-above -->

				<div id="post-3030" class="post-3030 post type-post status-publish format-standard hentry category-programming tag-c11 tag-correctness">
					<h1 class="entry-title">Constant&nbsp;initialization</h1>

					<div class="entry-meta">
						<span class="meta-prep meta-prep-author">Posted on</span> <a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/" title="7:55 pm" rel="bookmark"><span class="entry-date">May 27, 2012</span></a> 						<span class="by-author"><span class="sep">by</span> <span class="author vcard"><a class="url fn n" href="http://akrzemi1.wordpress.com/author/akrzemi1/" title="View all posts by Andrzej Krzemieński" rel="author">Andrzej Krzemieński</a></span> </span>					</div><!-- .entry-meta -->

					<div class="entry-content">
						<p>In one of my previous articles about <a href="http://akrzemi1.wordpress.com/2011/05/06/compile-time-computations/">compile-time computations</a> we have seen how you can ‘abuse’ the new keyword <code>constexpr</code>
 in order to achieve some interesting effects. Now it is time to show 
some of the intended usages of the keyword. I could probably write about
 creating more compile-time constants, but you probably know it already,
 for instance from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2235.pdf">this proposal</a>.</p>
<p>This article is about <em>constant initialization</em>.  In short, 
this is a new way global, static and thread-local objects (not 
necessarily constant) can be initialized without running into problems 
of initialization order or a data race. <span id="more-3030"></span></p>
<h3>Troubles with globals</h3>
<p>In this post, by ‘globals’ I mean a couple of categories of objects: </p>
<ul>
<li>namespace-scope objects with static storage duration (the namespace can be global or anonymous), </li>
<li>namespace-scope objects with thread storage duration, </li>
<li>static data members of classes, </li>
<li>temporaries bound to ‘global’ references. </li>
</ul>
<p>The usage of globals in C++ is problematic in many ways. They often 
make the programs difficult to reason about because they break the 
locality of the code. Whenever you call any function you do not know if 
it modified the global or not. Accessing globals is likely to introduce 
data races unless you remember to use atomic globals or protect your 
globals with some locking mechanism. Since C++ has no notion of ‘dynamic
 libraries’ it is unspecified how the globals behave when a program is 
dynamically linked to a library: should either have a copy of a global? 
Should globals be initialized before libraries are linked? But you 
cannot initialize globals in a dynamic library before you link with it… 
Next, globals can be accessed and used before they have been created or 
after they have been destroyed. </p>
<p>I only want to focus on one problem: the initialization order of globals. Consider this example spread across two files:</p>
<table>
<tbody><tr>
<td>file 1:<div class="syntaxhighlighter  " id="highlighter_288302"><div class="bar "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_288302_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_288302" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">extern</code> <code class="plain">std::mutex m; </code><code class="comments">// declaration</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">std::</code><code class="keyword bold">thread</code> <code class="plain">t1{job1};</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">std::</code><code class="keyword bold">thread</code> <code class="plain">t2{job2};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="comments">//...</code></td></tr></tbody></table></div></div></div></td>
<td>file 2:<div class="syntaxhighlighter  " id="highlighter_390477"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_390477_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_390477" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">std::mutex m; </code><code class="comments">// definition</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="spaces">&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;</code>&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="comments">// ...</code></td></tr></tbody></table></div></div></div></td>
</tr>
</tbody></table>
<p>The situation with mutex <code>m</code> is fairly common in many 
programs: the declaration is made visible through a header file, and the
 global object is defined in a separate file. Then, before <code>main</code> starts we launch two threads that execute two jobs. Parts of the jobs may be executed before <code>main</code> starts The two threads will have to synchronize on the mutex <code>m</code>.
 Synchronizing on the mutex requires checking if it is locked (reading 
its value) and locking it (writing the value). But by the time the first
 of the threads attempts to lock the mutex for the first time, do you 
think the mutex will have been initialized with the default constructor?</p>
<p>If you are aware of the problem called “<a href="http://www.parashift.com/c++-faq-lite/ctors.html#faq-10.14"><code>static</code> initialization order fiasco</a>,” you probably already sensed the problem: <code>m</code> is a global in one <em>translation unit</em> (file), <code>t1</code> and <code>t2</code> are globals defined in another translation unit, the order of initialization between globals in different translation units is <em>usually</em> indeterminate…</p>
<p>I emphasized word ‘usually’ because in C++11, much more than in 
C++03, this is not always the problem, and in fact, the above example is
 free from  initialization order fiasco problem owing to the feature 
called <em>static initialization.</em></p>
<h3>Zero-initialization</h3>
<p>The mechanism in general can be described as follows: if the 
constructor of your type meets certain constraints, and arguments passed
 at construction meet certain constraints, your global is guaranteed to 
be initialized before the program is even run: at compile-time. This 
mechanism isn’t entirely new and used to be available in C++03 in 
limited form of <em>zero-initialization.</em> </p>
<p>Globals of types with trivial default constructor — like <code>int</code>s, <code>float</code>s,
 pointers or aggregates thereof — without any explicit initializer, are 
always initialized with zeros at compile-time. This is easily achieved, 
as globals reside at global addresses, known at compile-time (although 
this is not the case for thread-local objects), and it doesn’t cost the 
compiler a lot to fill this memory with zeros. This is different for 
automatic objects which are allocated at run-time, and zeroing them out 
would incur some run-time overhead.</p>
<p>Zero-initialization of globals is sufficient for a number of useful 
designs. For instance, we can make a counter by declaring a global <code>int</code> without any initializer:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_73529"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_73529_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_73529" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="color1 bold">int</code> <code class="plain">counter; </code><code class="comments">// no initializer</code></td></tr></tbody></table></div></div></div><p></p>
<p>And we are guaranteed that it is initially set to zero. Similarly, we can implement a lazy load using a raw pointer like this:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_734814"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_734814_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_734814" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">Utility * ptr; </code><code class="comments">// no initializer</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">Utility &amp; getUtility()</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword bold">if</code> <code class="plain">(!ptr) {</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="plain">ptr = </code><code class="keyword bold">new</code> <code class="plain">Utility;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">}</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword bold">return</code> <code class="plain">*ptr;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>9</code></td><td class="content"><code class="plain">}</code></td></tr></tbody></table></div></div></div><p></p>
<p>And again, we are guaranteed that we start with a null-pointer value.
 However, (concurrency issues aside) we have a problem with the last 
example: someone needs to destroy the lazily loaded object. You could 
think about using a smart pointer, but a smart pointer is not a 
‘primitive’ type and most likely has a user-provided default constructor
 (or no default constructor). The zero-initialization guarantee is lost.</p>
<p>So, you could think about the approach to initialization <a href="http://golang.org/doc/effective_go.html#data">encouraged in language Go</a>:
 just arrange data in your type so that zero-initialization puts your 
object in a valid and ready to use state. For pointer it is easy:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_419244"><div class="bar "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_419244_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_419244" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">template</code> <code class="plain">&lt;</code><code class="keyword bold">class</code> <code class="plain">T&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">SmartPointer</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">T * rawPtr_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// no constructor</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>Zero initialization will put your object into a well-understood 
state: a null smart pointer storing a null raw pointer. In the case of 
mutex, this approach constraints the implementation. This is how an 
implementation for mutex could look like:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_822934"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_822934_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_822934" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">mutex</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="color1 bold">bool</code> <code class="plain">youCanLockMe_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">vector&lt;</code><code class="keyword bold">thread</code><code class="plain">::id&gt; threadsLocked_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// invariant: if (youCanLockMe_) threadsLocked_.empty();</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>Here, <code>youCanLockMe_</code> indicates that no thread has locked the mutex, and <code>threadsLocked_</code>
 contains the list of threads that are currently locked and need to be 
notified if the current owner has released the lock. This implementation
 will not work with zero-initialization for two reasons. Flag <code>youCanLockMe_</code> will be zero-initialized to <code>false</code> which will mean that the mutex is initially locked and there would be no-one to unlock it. Second, <code>vector</code>
 cannot be used when zero-initialized: its default constructor (only 
called at run-time) still needs to be called before any attempt to 
access the vector: otherwise we would get a <a href="http://blog.regehr.org/archives/213" title="Undefined Behavior">UB</a>.</p>
<p>On the other hand, the following implementation would work:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_398011"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_398011_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_398011" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">treadIdLink</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword bold">thread</code><code class="plain">::id id_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">SmartPointer&lt;treadIdLink&gt; next_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">mutex</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="color1 bold">bool</code> <code class="plain">locked_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">SmartPointer&lt;treadIdLink&gt; threadsLocked_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>11</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// invariant: if (!locked_) threadsLocked_ == nullptr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>12</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>Now we ‘inverted’ the meaning of the flag, so now the 
zero-initialized flag indicates a ready-to-lock mutex. We also store the
 list of locked threads in a linked list. This way, we can represent an 
empty list with a null-pointer: the result of zero-initializing a smart 
pointer (hopefully). </p>
<p>While the above approach is acceptable for a mutex (because it does 
not need any other constructor), it will not in fact work for our <code>SmartPointer</code>
 because a smart pointer really needs other constructors: e.g., one that
 takes a raw pointer. Then, if we provide a constructor, compiler 
requires of us to provide a default constructor, and if we do, using our
 pointer before its (run-time) default constructor is called would be a 
UB. But even if we defined our smart pointer without any constructor it 
still (as well as our <code>mutex</code>) has another serious problem: 
zero-initialization will only work for globals; creating automatic 
objects or dynamically creating objects would result in garbage initial 
value (as it is the case for basic types like <code>int</code>s, <code>float</code>s, pointers or aggregates thereof).</p>
<h3>Constant initialization</h3>
<p>C++11 extends the idea of zero-initialization so that any initialization of globals that is <em>sufficiently simple</em>
 is guaranteed to be performed at compile-time. You can already guess 
that ‘sufficiently simple’ is defined by the same rules that govern <code>constexpr</code> functions and constructors. This is probably nothing new to you that <code>constexpr</code>
 functions can be used to evaluate and create constants of complex types
 at compile-time, but here we are talking about initializing objects 
that are not const at all: a mutex is meant to change its state in time.</p>
<p>So how do C++11 rules work? After all globals have been zero-initialized, <em>constant initialization</em> takes place: every global object whose initialization involves only the access to compile-time constants and evaluation of <em>constant expressions</em>
 has its initial value set at compile-time, before any run-time 
initialization of globals takes place. Thus initialized object does not 
itself have to be a compile-time constant (and if so, its value cannot 
be used in constant initialization of other globals). </p>
<p>How do we use it? With almost no effort:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_426742"><div class="bar  "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_426742_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_426742" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">template</code> <code class="plain">&lt;</code><code class="keyword bold">class</code> <code class="plain">T&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">SmartPointer</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">T * rawPtr_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">constexpr SmartPointer() noexcept : rawPtr_{nullptr} {};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// other constructors</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>This declaration may look a bit awkward at first but lets inspect it in detail. <code>constexpr</code> says that this constructor is a <code>constexpr</code>-constructor; i.e., it could be used to create compile-time constants if our class were a <em>literal type</em>
 (but our pointer is not one) or it can be executed during the 
static-initialization phase, provided that any expression involved is a 
constant expression — and this property does not require that our type 
be a <em>literal type</em>. <code>noexcept</code> is not essential for 
constant initialization, but since we are defining a very simple 
function (so simple that it can be initialized at compile-time with 
constant expressions) it is worth also signalling that this is a no-fail
 function and could be used as a building block in implementing strong 
and basic exception safety guarantees. Our constructor is not trivial: a
 trivial constructor would not initialize the <code>rawPtr_</code> to 
null-pointer value, so we initialize it explicitly. Setting a raw 
pointer to null-pointer value is a constant expression, so in turn, our 
constructor is a simple enough type to guarantee static initialization.</p>
<p>What does this buy us? Now if a global object of type <code>SmartPointer&lt;T&gt;</code>
 is initialized with a default constructor, the language guarantees that
 the initialization is performed at compile time, so that we will never 
run onto the order-of-initialization issue. At the same time other 
constructors may require dynamic initialization. We create the global 
the same way we would in C++03:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_378503"><div class="bar "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_378503_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_378503" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="comments">// at global namespace</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">SmartPointer&lt;</code><code class="color1 bold">int</code><code class="plain">&gt; intPtr;</code></td></tr></tbody></table></div></div></div><p></p>
<p>We do not need to (and in fact should not) type any <code>constexpr</code>. It is enough that the default constructor is declared as <code>constexpr</code> constructor. <code>intPtr</code>
 is not a compile-time constant. It is not even a ‘run-time constant’ we
 ca change its value at will at run-time. It is only the initialization 
that is guaranteed to be performed at compile-time. Similarly, we can 
guarantee that the mutex is const-initialized:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_867213"><div class="bar  "><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_867213_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_867213" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">mutex</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="color1 bold">bool</code> <code class="plain">locked_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">SmartPointer&lt;treadIdLink&gt; threadsLocked_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// invariant: if (!locked_) threadsLocked_ == nullptr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">constexpr mutex() noexcept : locked_{</code><code class="keyword bold">false</code><code class="plain">}, threadsLocked_{nullptr} {};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>We do not have to initialize our members with zero values, so the following implementation is also possible:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_283063"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_283063_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_283063" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">mutex</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="color1 bold">bool</code> <code class="plain">youCanLockMe_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">SmartPointer&lt;treadIdLink&gt; threadsLocked_;</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// invariant: if (youCanLockMe_) threadsLocked_ == nullptr;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>7</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">constexpr mutex() noexcept : youCanLockMe_{</code><code class="keyword bold">true</code><code class="plain">}, threadsLocked_{nullptr} {};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>8</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div><p></p>
<p>However, we cannot go back to using <code>std::vector</code> for storing locked thread IDs because vector’s default constructor is not (required to be) a <code>constexpr</code> constructor.</p>
<h3>Constant initialization gotchas</h3>
<p>So we have a tool that enables us to perform some classes of globals’
 initialization at compile-time. But there are some essential 
difficulties that we should pay attention to when relying on constant 
initialization. </p>
<p>It is difficult to assert that the initialization of globals really 
took place at compile-time. You can inspect the binary, but it only 
gives you the guarantee for this binary and is not a guarantee for the 
program, in case you target for multiple platforms, or use various 
compilation modes (like debug and retail). The compiler may not help you
 with that. There is no way (no syntax) to require a verification by the
 compiler that a given global is const-initialized. If you were 
initializing a constant of a literal type you could ask the compiler to 
check that:</p>
<p></p><div class="syntaxhighlighter  " id="highlighter_87652"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_87652_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_87652" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">constexpr </code><code class="color1 bold">double</code> <code class="plain">x{1.0};</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="color1 bold">double</code> <code class="plain">y{2.0};&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// ups! y is not a compile-time constant</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="keyword bold">const</code> <code class="plain">Complex c1{x, y};&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="comments">// constant initialized at run-time </code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">constexpr Complex c2{x, y}; </code><code class="comments">// error: y is not a compile-time constant.</code></td></tr></tbody></table></div></div></div> <p></p>
<p>The second use of <code>constexpr</code> tells the compiler to verify that all expressions used to initialize <code>c2</code> are constant expressions (and ‘<code>y</code>’
 is not); but apart from constant initialization we also requested the 
immutability of the object. If we only require constant initialization 
alone we cannot use <code>constexpr</code> specifier, but then if we 
inadvertently use even one sub-expression that is not a constant 
expression (and some expressions, like type conversions, are not even 
visible) we silently move the initialization to run-time. Therefore the 
best way to avoid such potential problems is to rely with the constant 
initialization only on default constructors which cannot inadvertently 
take ‘non-constant-expression’ arguments.</p>
<p>Another gotcha lies in the fact that in case of <code>constexpr</code> function/constructor templates, if a given instantiation of a function fails to meet all the requirements imposed on the <code>constexpr</code> function, compiler is allowed (and in fact required) to silently drop the <code>constexpr</code> specifier and downgrade it to an ordinary function. Therefore, it is safer if we use ‘non-template’ types like <code>mutex</code>, or if it is a template parametrized by <code>T</code>, not call any operations of <code>T</code> (which we know nothing about) — this is the case for our <code>SmartPtr</code>.</p>
<p>And this is more-less the guidelines adapted by the C++ Standard 
Library. Apart from generating compile-time constants, static 
initialization is only provided for default construction and 
construction from <code>nullptr</code> for several types: <code>std::unique_ptr</code>, <code>std::shared_ptr</code>, <code>std::weak_ptr</code>, <code>std::mutex</code>, <code>std::once_flag</code>.
 One cold also expect a similar guarantee of STL containers, however 
while such requirement makes sense, it was decided that it would be too 
much a constraint for STD library providers, who need to have some 
flexibility in how they want to implement the library to meet other 
goals, such as run-time efficiency.</p>
<p>An interesting exception from these guidelines is class template <code>std::atomic</code>, where default constructor is not <code>constexpr</code>
 (it leaves the value uninitialized in order to guarantee maximum 
run-time performance for automatic objects, compatible with C language),
 but value constructors are.</p>
<h3>Summary</h3>
<p>I have exaggerated a bit about initialization at compile-time. What 
the C++ Standard really guarantees is that zero-initialization 
(initialization with zeros) and constant initialization (initialization 
with constants) (the two are collectively called <em>static initialization</em>)
 are performed before any other (dynamic) initialization takes place in 
the program. Thus, it is possible that some time at the program start-up
 will be taken for static initialization. Yet, anything said about 
avoiding the order-of-initialization problems holds, and because 
compiler writers are driven not only by the ISO C++ Standard but also by
 the market needs (e.g., performance) it is natural to expect that such 
initialization should be done by the compiler; for free.</p>
<p>One observation that its worth repeating here is that <code>constexpr</code> functions/constructors play two different roles:</p>
<ol>
<li>Creating and evaluating compile-time constants of fairly complex types.</li>
<li>Initializing mutable global objects of fairly complex types at compile-time.</li>
</ol>
<h3>References</h3>
<ol>
<li>“Generalized constant expressions” — a sequence of proposals for generalizing constant expressions (<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2003/n1521.pdf">N1521</a>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1972.pdf">N1972</a>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1980.pdf">N1980</a>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2116.pdf">N2116</a>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2235.pdf">N2235</a>) by Gabriel Dos Reis, Bjarne Stroustrup and Jens Maurer.
</li>
<li>The C++ International Standard. It used to be accessible from the 
Committee’s website. If you need to refer to an online resource, the 
latest standard draft — <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3376.pdf">N3376</a>
 — is pretty similar in content. The following are the relevant places 
therein: § 3.6.2 (Initialization of non-local variables), § 3.8 (Object 
lifetime), § 5.19 (Constant expressions), § 7.1.5 (The <code>constexpr</code> specifier), § 8.5 (Initializers), § 12.1 (Constructors), § 12.9 (Inheriting constructors).</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2994.htm">N2994</a>: “<code>constexpr</code> in the libray: take 2” by Alisdair Meredith. It contains loads of useful information about constant initialization.</li>
</ol>

<div class="wpadvert" style="position: relative; width:300px; text-align: center; padding: 0; margin: 10px auto; overflow: hidden;">
<a style="position: absolute; text-align: left; display: block; font: 9px/1 sans-serif; text-decoration: underline;" href="http://en.wordpress.com/about-these-ads/" rel="nofollow">About these ads</a>
<script type="text/javascript">
GA_googleAddAttr("AdOpt", "1");
GA_googleAddAttr("Origin", "other");
GA_googleAddAttr("LangId", "1");
GA_googleAddAttr("Domain", "akrzemi1.wordpress.com");
GA_googleAddAttr("BlogId", "21765996");
GA_googleAddAttr("AdSafe", "1");
GA_googleAddAttr("Autotag", "technology");
GA_googleAddAttr("Autotag", "science");
GA_googleAddAttr("Tag", "programming");
GA_googleAddAttr("Tag", "c11");
GA_googleAddAttr("Tag", "correctness");
GA_googleAddAttr("theme_bg", "ffffff"); 
GA_googleAddAttr("theme_text", "333333"); 
GA_googleAddAttr("theme_link", "0066cc"); 
GA_googleAddAttr("theme_border", "cccccc"); 
GA_googleAddAttr("theme_url", "ff4b33"); 
GA_googleAddAdSensePageAttr("google_page_url", "http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/");
GA_googleFillSlot("wpcom_below_post_adsafe");
</script>
</div>
<style type="text/css">
div.wpadvert>div { margin-top: 1em; }
</style>
<script type="text/javascript">
jQuery( window ).load( function() {
    if ( jQuery(".wpadvert script[src*='shareth.ru']").length > 0 || jQuery(".wpadvert .sharethrough-placement").length > 0 ) {
        jQuery( '.wpadvert' ).css( 'width', '400px' );
    }
setTimeout(function(){if(typeof GS_googleAddAdSenseService !== 'function'){new Image().src=document.location.protocol+"//stats.wordpress.com/g.gif?v=wpcom-no-pv&x_noads=adblock&baba="+Math.random()}},100);
} );
</script>
<div id="jp-post-flair" class="sharedaddy sd-rating-enabled sd-like-enabled"><div class="sd-block sd-rating"><h3 class="sd-title">Rate this:</h3><div style="display: inline-block;" class="pd-rating" id="pd_rating_holder_4527172_post_3030"><div class="rating-icons" id="pd_rate_4527172_post_3030" style="float:left;"><div onmouseout="PDRTJS_4527172_post_3030.rebuild();" onclick="PDRTJS_4527172_post_3030.rate(1);" onmouseover="PDRTJS_4527172_post_3030.hover(1);" id="PDRTJS_4527172_post_3030_stars_1" style="background-size: 32px 48px!important; cursor: pointer; width: 16px; height: 16px; line-height: 16px; background: url(http://i0.poll.fm/ratings/images/star-yellow-sml.png) top left; float: left; padding: 0px; marging: 0px; margin-right: 1px;">&nbsp;</div><div onmouseout="PDRTJS_4527172_post_3030.rebuild();" onclick="PDRTJS_4527172_post_3030.rate(2);" onmouseover="PDRTJS_4527172_post_3030.hover(2);" id="PDRTJS_4527172_post_3030_stars_2" style="background-size: 32px 48px!important; cursor: pointer; width: 16px; height: 16px; line-height: 16px; background: url(http://i0.poll.fm/ratings/images/star-yellow-sml.png) top left; float: left; padding: 0px; marging: 0px; margin-right: 1px;">&nbsp;</div><div onmouseout="PDRTJS_4527172_post_3030.rebuild();" onclick="PDRTJS_4527172_post_3030.rate(3);" onmouseover="PDRTJS_4527172_post_3030.hover(3);" id="PDRTJS_4527172_post_3030_stars_3" style="background-size: 32px 48px!important; cursor: pointer; width: 16px; height: 16px; line-height: 16px; background: url(http://i0.poll.fm/ratings/images/star-yellow-sml.png) top left; float: left; padding: 0px; marging: 0px; margin-right: 1px;">&nbsp;</div><div onmouseout="PDRTJS_4527172_post_3030.rebuild();" onclick="PDRTJS_4527172_post_3030.rate(4);" onmouseover="PDRTJS_4527172_post_3030.hover(4);" id="PDRTJS_4527172_post_3030_stars_4" style="background-size: 32px 48px!important; cursor: pointer; width: 16px; height: 16px; line-height: 16px; background: url(http://i0.poll.fm/ratings/images/star-yellow-sml.png) top left; float: left; padding: 0px; marging: 0px; margin-right: 1px;">&nbsp;</div><div onmouseout="PDRTJS_4527172_post_3030.rebuild();" onclick="PDRTJS_4527172_post_3030.rate(5);" onmouseover="PDRTJS_4527172_post_3030.hover(5);" id="PDRTJS_4527172_post_3030_stars_5" style="background-size: 32px 48px!important; cursor: pointer; width: 16px; height: 16px; line-height: 16px; background: url(http://i0.poll.fm/ratings/images/star-yellow-sml.png) top left; float: left; padding: 0px; marging: 0px; margin-right: 1px;">&nbsp;</div></div><span style="float:left;">&nbsp;</span><div id="rating_info_4527172_post_3030" style="display:block;float:left;background:url(http://i0.poll.fm/images/ratings/info.png) no-repeat 3px 2px;width:16px;height:16px;cursor:pointer; null " onclick="javascript:PDRTJS_4527172_post_3030.togglePopup();return false;"><span style="display:none;">i</span></div><div class="pd_popup_holder" id="pd_popup_holder_4527172_post_3030">&nbsp;</div><div class="rating-msg" id="PDRTJS_4527172_post_3030_msg" style="float:left; padding-left: 5px; text-align: left; font:normal normal /16px ; color: #;">1 Vote</div><p style="padding: 0px; margin: 0px; clear: both;"></p><img src="sampleWordPressPage2_files/p-ab3gTb8xb3dLg.gif" style="display: none;" alt="Quantcast" border="0" height="1" width="1"></div></div><div class="wpl-likebox sd-block sd-like"><h3 class="sd-title">Like this:</h3><div class="sd-content"><div id="like-3030" class="wpl-button "><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?like=1&amp;_wpnonce=8ff8af45e4" title="I like this." class="like needs-login sd-button" rel="nofollow"><span>Like</span></a></div><div class="wpl-count sd-like-count">Be the first to like this.</div></div></div></div>											</div><!-- .entry-content -->


					<div class="entry-utility">
						This entry was posted in <a href="http://akrzemi1.wordpress.com/category/programming/" title="View all posts in programming" rel="category tag">programming</a> and tagged <a href="http://akrzemi1.wordpress.com/tag/c11/" rel="tag">C++11</a>, <a href="http://akrzemi1.wordpress.com/tag/correctness/" rel="tag">correctness</a>. Bookmark the <a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/" title="Permalink to Constant&nbsp;initialization" rel="bookmark">permalink</a>.											</div><!-- .entry-utility -->
				</div><!-- #post-## -->

				<div id="nav-below" class="navigation">
					<div class="nav-previous"><a href="http://akrzemi1.wordpress.com/2012/04/23/using-pods-in-c11/" rel="prev"><span class="meta-nav">←</span> Using PODs in&nbsp;C++11</a></div>
					<div class="nav-next"><a href="http://akrzemi1.wordpress.com/2012/06/19/beware-of-magic-values/" rel="next">Beware of magic&nbsp;values! <span class="meta-nav">→</span></a></div>
				</div><!-- #nav-below -->

				
			<div id="comments">


			<h3 id="comments-title">9 Responses to <em>Constant&nbsp;initialization</em></h3>


			<ol class="commentlist">
					<li class="comment byuser comment-author-mpusz even thread-even depth-1 highlander-comment" id="li-comment-364">
		<div id="comment-364">
			<div class="comment-author vcard">
				<img id="grav-37e370fb4e87500805abb44c8820ec1f-0" alt="" src="sampleWordPressPage2_files/37e370fb4e87500805abb44c8820ec1f.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn">Mateusz Pusz</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-364">
				June 12, 2012 at 11:36 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Nice article. I have a question though. 
Instead of writing constructors for Constant Initialization wouldn’t it 
be easier to use in-class member initializers? C++11 compiler has to 
prefix a constructor with constexpr if only possible so it could be much
 easier to implement than to maintain constructors code later on.<br>
And one more thing. You probably meant “and ‘y’ is not” in “Constant initialization gotchas” section?</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=364#respond" onclick='return addComment.moveForm("comment-364", "364", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-akrzemi1 bypostauthor odd alt depth-2 highlander-comment" id="li-comment-365">
		<div id="comment-365">
			<div class="comment-author vcard">
				<img id="grav-c3baf4aa5bebf6d1407ed4e3b0981864-0" alt="" src="sampleWordPressPage2_files/c3baf4aa5bebf6d1407ed4e3b0981864.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn"><a href="http://akrzemi1.wordpress.com/" rel="external nofollow" class="url">Andrzej Krzemieński</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-365">
				June 12, 2012 at 12:17 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>An interesting observation. I have not thought of that. It would definitely be a better alternative for <code>mutex</code> class. It would also work for <code>SmartPointer</code> above, although I would hesitate before default-initializing a member pointer to <code>nullptr</code>, because it is not that often that the <code>SmartPointer</code> will be default-initialized. </p>
<p>I am now quickly trying to think if this technique could be generalized beyond the two examples from this post. Consider class:</p>
<div class="syntaxhighlighter  " id="highlighter_324704"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_324704_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_324704" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>01</code></td><td class="content"><code class="keyword bold">template</code> <code class="plain">&lt;</code><code class="keyword bold">class</code> <code class="plain">T&gt;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>02</code></td><td class="content"><code class="keyword bold">class</code> <code class="plain">optional </code><code class="comments">// like Boost.Optional</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>03</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>04</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="color1 bold">bool</code> <code class="plain">initialized_; </code><code class="comments">// what default?</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>05</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">Storage&lt;T&gt; storage_;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>06</code></td><td class="content"><code class="keyword bold">public</code><code class="plain">:</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>07</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">constexpr optional(none_t) noexcept; </code><code class="comments">// initialize empty</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>08</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="plain">constexpr optional() noexcept; </code><code class="comments">// nonempty: call T();</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>09</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="comments">// ...</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>10</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div></div></div>
<p>These two constructors are special and probably both deserve a chance
 to participate in constant initialization, but require to be 
initialized to different (and somewhat opposite) states.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=365#respond" onclick='return addComment.moveForm("comment-365", "365", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-mpusz even depth-3 highlander-comment" id="li-comment-366">
		<div id="comment-366">
			<div class="comment-author vcard">
				<img id="grav-37e370fb4e87500805abb44c8820ec1f-1" alt="" src="sampleWordPressPage2_files/37e370fb4e87500805abb44c8820ec1f.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn">Mateusz Pusz</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-366">
				June 12, 2012 at 12:34 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>If you need 2 constructors than you know
 that you have to provide default constructor because it will not be 
created for you. However you can manually declare it as constexpr and 
use = default to make compiler provide a body based on your in-class 
member initialization. The other (not default) constructor still has to 
be provided by hand and initialized properly.<br>
The only downside I see with in-class member initializers od PODs is a 
non global usage where all members will still be somehow initialized 
while in ‘regular’ way their initialization would be just skipped. It 
may cause some performance penalty for some guys that really count every
 CPU cycle. However that is exactly the same case as yours with 
constexpr default constructors.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=366#respond" onclick='return addComment.moveForm("comment-366", "366", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li>
</ul>
</li>
</ul>
</li>
	<li class="comment odd alt thread-odd thread-alt depth-1 highlander-comment" id="li-comment-367">
		<div id="comment-367">
			<div class="comment-author vcard">
				<img id="grav-6434613b3d4e3582411be9be25d8b80f-0" alt="" src="sampleWordPressPage2_files/6434613b3d4e3582411be9be25d8b80f.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn">bobobobo</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-367">
				June 17, 2012 at 8:16 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>constexpr SmartPointer() noexcept : rawPtr_{nullptr} {};<br>
Let me ask two questions.<br>
1. Why is there a semicolon after ctor definition? Seems to be redundant.<br>
2. Why noexcept? I thought constexpr implies noexcept.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=367#respond" onclick='return addComment.moveForm("comment-367", "367", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-akrzemi1 bypostauthor even depth-2 highlander-comment" id="li-comment-368">
		<div id="comment-368">
			<div class="comment-author vcard">
				<img id="grav-c3baf4aa5bebf6d1407ed4e3b0981864-1" alt="" src="sampleWordPressPage2_files/c3baf4aa5bebf6d1407ed4e3b0981864.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn"><a href="http://akrzemi1.wordpress.com/" rel="external nofollow" class="url">Andrzej Krzemieński</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-368">
				June 17, 2012 at 10:55 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>@bobobobo:</p>
<ol>
<li>Indeed, the semicolon is redundant.</li>
<li>While it may appear confusing, <code>constexpr</code> does not imply <code>noexcept</code>,and in fact <code>constexpr</code> functions are allowed to throw, and it may prove useful. <code>constexpr</code>
 functions can be executed at run-time, and when it comes to 
compile-time, there should exist a “control path” that only involves 
compile-time evaluations, but it is allowed to also have control paths 
that require run-time evaluations: provideded that these paths are not 
executed at compile-time. For examples, see my other post on <a href="http://akrzemi1.wordpress.com/2011/05/06/compile-time-computations/" rel="nofollow">compile-time computations</a>.  </li>
</ol>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=368#respond" onclick='return addComment.moveForm("comment-368", "368", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li>
</ul>
</li>
	<li class="comment odd alt thread-even depth-1 highlander-comment" id="li-comment-439">
		<div id="comment-439">
			<div class="comment-author vcard">
				<img id="grav-2d24277226f4c86d39c2b63c3ea590dc-0" alt="" src="sampleWordPressPage2_files/2d24277226f4c86d39c2b63c3ea590dc.png" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn">Scott Tillman</cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-439">
				September 14, 2012 at 6:51 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>I’m extremely glad to hear that compile 
time initialization has found it’s way into the good graces of C++.  The
 only thing I don’t see in your discussions is whether linker resolved 
addresses are considered valid constexpr elements.  As an example, I 
have some initializers which look like this:</p>
<p>   typedef struct DoubleLinkedList_struct {<br>
      DoubleLinkedListNode m_anchor;<br>
   } DoubleLinkedList;<br>
   #define DoubleLinkedList_INITIALIZER(me)   { {&amp;(me)-&gt;m_anchor,&amp;(me)-&gt;m_anchor,}, }</p>
<p>such that I can compile (really link) time initialize a global instance like this:</p>
<p>    DoubleLinkedList g_list = DoubleLinkedList_INITIALIZER(&amp;g_list);</p>
<p>Essentially the structure points to itself (creating an empty list). 
 Is &amp;g_list now considered a constexpr?  Thanks for this writeup.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=439#respond" onclick='return addComment.moveForm("comment-439", "439", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li>
	<li class="comment byuser comment-author-akrzemi1 bypostauthor even thread-odd thread-alt depth-1 highlander-comment" id="li-comment-441">
		<div id="comment-441">
			<div class="comment-author vcard">
				<img id="grav-c3baf4aa5bebf6d1407ed4e3b0981864-2" alt="" src="sampleWordPressPage2_files/c3baf4aa5bebf6d1407ed4e3b0981864.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn"><a href="http://akrzemi1.wordpress.com/" rel="external nofollow" class="url">Andrzej Krzemieński</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-441">
				September 16, 2012 at 7:32 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>Hi Scott. Thanks for the interesting 
question. The answer, if I correctly understood your question, is yes. 
Quoting the Standard (§5.19 ¶3):</p>
<blockquote><p>
An <em>address constant expression</em> is a prvalue core constant 
expression of pointer type that evaluates to the address of an object 
with static storage duration, to the address of a function, or to a null
 pointer value, or a prvalue core constant expression of type <code>std::nullptr_t</code>. Collectively, literal constant expressions, reference constant expressions, and address constant expressions are called <em>constant expressions</em>.
</p></blockquote>
<p>Thus, for instance, the following code compiles fine (in GCC 4.7):</p>
<div class="syntaxhighlighter  " id="highlighter_499664"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_499664_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_499664" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="keyword bold">struct</code> <code class="plain">Node</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>2</code></td><td class="content"><code class="plain">{</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>3</code></td><td class="content"><code class="spaces">&nbsp;&nbsp;</code><code class="keyword bold">const</code> <code class="plain">Node * anchor;</code></td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>4</code></td><td class="content"><code class="plain">};</code></td></tr></tbody></table></div><div class="line alt1"><table><tbody><tr><td class="number"><code>5</code></td><td class="content">&nbsp;</td></tr></tbody></table></div><div class="line alt2"><table><tbody><tr><td class="number"><code>6</code></td><td class="content"><code class="plain">constexpr Node gNode = {&amp;gNode};</code></td></tr></tbody></table></div></div></div>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=441#respond" onclick='return addComment.moveForm("comment-441", "441", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li>
	<li class="comment byuser comment-author-mmocny odd alt thread-even depth-1 highlander-comment" id="li-comment-508">
		<div id="comment-508">
			<div class="comment-author vcard">
				<img id="grav-05aa36ab5c7d2c620d27d86415ba2eb7-0" alt="" src="sampleWordPressPage2_files/05aa36ab5c7d2c620d27d86415ba2eb7.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn"><a href="http://mmocny.wordpress.com/" rel="external nofollow" class="url">Michal Mocny</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-508">
				October 11, 2012 at 5:21 pm</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>I’ve been putting off reading this article for quite some time, and now I wish I hadn’t!<br>
Thanks so much for clearing up a lot of my misunderstanding on the usage
 of constexpr on constructors and also on constant initialization.<br>
Still, constant initialization correctly continues to seem fairly “expert friendly” :/<br>
I’m curious to try out Mateusz Pusz’s suggestion of class member initializers.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=508#respond" onclick='return addComment.moveForm("comment-508", "508", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	<ul class="children">
	<li class="comment byuser comment-author-akrzemi1 bypostauthor even depth-2 highlander-comment" id="li-comment-514">
		<div id="comment-514">
			<div class="comment-author vcard">
				<img id="grav-c3baf4aa5bebf6d1407ed4e3b0981864-3" alt="" src="sampleWordPressPage2_files/c3baf4aa5bebf6d1407ed4e3b0981864.jpeg" class="avatar avatar-40 grav-hashed grav-hijack" height="40" width="40">				<cite class="fn"><a href="http://akrzemi1.wordpress.com/" rel="external nofollow" class="url">Andrzej Krzemieński</a></cite> <span class="says">says:</span>			</div><!-- .comment-author .vcard -->
			
			<div class="comment-meta commentmetadata"><a href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#comment-514">
				October 12, 2012 at 9:37 am</a>			</div><!-- .comment-meta .commentmetadata -->

			<div class="comment-body"><p>My overall impression of constant 
initialization is that it is simply dangerous if you try to use it for 
constructors other than the default one (or the ones that only take tags
 like <code>nullptr_t</code>, <code>boost::none_t</code>): because there are no means to verify if all prerequisites for constant initialization have been met.</p>
<p>One thing that normal programmers could be taught is to identify classes where you are able to provide a <em>simple</em>
 default constructor. ‘Simple’ here would mean not requiring any 
resources, impossible to fail (and throw exceptions), do the minimum for
 the object to be able to say that it has not been assigned a proper 
value yet. This is the case for all smart and dumb pointers, <code>boost::optional</code> and other <em>nullable</em> types like <code>std::function</code>. (These classes would also provide other constructors, so the default one will not get auto-generated.)</p>
<p>Once identified, declare it as:</p>
<div class="syntaxhighlighter  " id="highlighter_906966"><div class="bar"><div class="toolbar"><a class="item viewSource" style="width: 16px; height: 16px;" title="view source" href="#viewSource">view source</a><div class="item copyToClipboard"><embed id="highlighter_906966_clipboard" type="application/x-shockwave-flash" title="copy to clipboard" allowscriptaccess="always" wmode="transparent" flashvars="highlighterId=highlighter_906966" menu="false" src="sampleWordPressPage2_files/clipboard.swf" height="16" width="16"></div><a class="item printSource" style="width: 16px; height: 16px;" title="print" href="#printSource">print</a><a class="item about" style="width: 16px; height: 16px;" title="?" href="#about">?</a></div></div><div class="lines"><div class="line alt1"><table><tbody><tr><td class="number"><code>1</code></td><td class="content"><code class="plain">constexpr MyType::MyType() noexcept = </code><code class="keyword bold">default</code><code class="plain">;</code></td></tr></tbody></table></div></div></div>
<p>In order to enable the static initialization.</p>
<p>The ‘default’ follows Mateusz’s suggestion to initialize members in 
their declaration. The ‘noexcept’ is not necessary in this exercise, but
 it feels logical for types with so simple initialization.</p>
</div>

			<div class="reply">
				<a class="comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/?replytocom=514#respond" onclick='return addComment.moveForm("comment-514", "514", "respond", "3030")'>Reply</a>			</div><!-- .reply -->
		</div><!-- #comment-##  -->

	</li>
</ul>
</li>
			</ol>




								<div class="js" id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://akrzemi1.wordpress.com/wp-comments-post.php" method="post" id="commentform">
																										


												
<input name="hc_post_as" id="hc_post_as" value="guest" type="hidden">

<div class="comment-form-field comment-textarea">
	
	<div id="comment-form-comment"><textarea tabindex="-1" style="height: 44px; resize: none; overflow-y: hidden; position: absolute; top: 0px; left: -9999px; width: 618px; line-height: 24px; text-decoration: none; letter-spacing: 0px;" placeholder="Enter your comment here..."></textarea><textarea style="height: 44px; resize: none; overflow-y: hidden;" placeholder="Enter your comment here..." id="comment" name="comment"></textarea></div>
</div>

<div style="display: none;" id="comment-form-identity">

	<div id="comment-form-nascar">
		<p>Fill in your details below or click an icon to log in:</p>
		<ul>
			<li class="selected" style="display:none;">
				<a href="#comment-form-guest" id="postas-guest" title="Guest">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter">
					<span></span>
				</a>
			</li>
			<li>
				<a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook">
					<span></span>
				</a>
			</li>
		</ul>
	</div>

	<div id="comment-form-guest" class="comment-form-service selected">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
<a href="https://gravatar.com/site/signup/" target="_blank">				<img src="sampleWordPressPage2_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Gravatar" class="no-grav" width="25">
</a>			</div>

				<div class="comment-form-fields">
				<div class="comment-form-field comment-form-email">
					<label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label>
					<div class="comment-form-input"><input id="email" name="email" type="email"></div>
				</div>
				<div class="comment-form-field comment-form-author">
					<label for="author">Name <span class="required">(required)</span></label>
					<div class="comment-form-input"><input id="author" name="author" type="text"></div>
				</div>
				<div class="comment-form-field comment-form-url">
					<label for="url">Website</label>
					<div class="comment-form-input"><input id="url" name="url" type="text"></div>
				</div> 
			</div>
	
		</div>
	</div>

	<div id="comment-form-wordpress" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="sampleWordPressPage2_files/wplogo.png" alt="WordPress.com Logo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value="" type="hidden">
				<input name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value="" type="hidden">
				<p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'wordpress'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-twitter" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="sampleWordPressPage2_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Twitter picture" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value="" type="hidden">
				<input name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value="" type="hidden">
				<p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'twitter'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>

	<div id="comment-form-facebook" class="comment-form-service">
		<div class="comment-form-padder">
			<div class="comment-form-avatar">
				<img src="sampleWordPressPage2_files/ad516503a11cd5ca435acc9bb6523536.png" alt="Facebook photo" class="no-grav" width="25">
			</div>

				<div class="comment-form-fields">
				<input name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value="" type="hidden">
				<input name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value="" type="hidden">
				<p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout(%20'facebook'%20);">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p>
			</div>
	
		</div>
	</div>


	<div id="comment-form-load-service" class="comment-form-service">
		<div class="comment-form-posting-as-cancel"><a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a></div>
		<p>Connecting to %s</p>
	</div>
	
	
</div>

<script type="text/javascript">
jQuery(document).ready(function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
});
</script>

<div style="display: none;" id="comment-form-subscribe"> 
	<p class="comment-subscription-form"><input name="subscribe" id="subscribe" value="subscribe" style="width: auto;" tabindex="6" type="checkbox"> <label class="subscribe-label" id="subscribe-label" for="subscribe">Notify me of follow-up comments via email.</label></p><p class="post-subscription-form"><input name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;" tabindex="7" type="checkbox"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts via email.</label></p></div>

												<p style="display: none;" class="form-submit">
							<input name="submit" id="comment-submit" value="Post Comment" type="submit">
							<input name="comment_post_ID" value="3030" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
						</p>
						
<input name="genseq" value="1352495277" type="hidden">
<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="934e67f285" type="hidden"></p><script type="text/javascript" src="sampleWordPressPage2_files/form.js"></script>
<p style="display: none;"><input id="ak_js" name="ak_js" value="1352495278707" type="hidden"></p>					</form>
							</div><!-- #respond -->
			<div style="clear: both"></div>			
</div><!-- #comments -->


			</div><!-- #content -->
		</div><!-- #container -->


		<div id="primary" class="widget-area" role="complementary">
						<ul class="xoxo">

<li id="search-2" class="widget-container widget_search"><form role="search" method="get" id="searchform" action="http://akrzemi1.wordpress.com/">
	<div><label class="screen-reader-text" for="s">Search for:</label>
	<input name="s" id="s" type="text">
	<input id="searchsubmit" value="Search" type="submit">
	</div>
	</form></li>		<li id="recent-posts-2" class="widget-container widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
					<li>
				<a href="http://akrzemi1.wordpress.com/2012/10/29/user-defined-literals-part-iii/" title="User-defined literals — Part&nbsp;III">User-defined literals — Part&nbsp;III</a>
						</li>
					<li>
				<a href="http://akrzemi1.wordpress.com/2012/10/23/user-defined-literals-part-ii/" title="User-defined literals — Part&nbsp;II">User-defined literals — Part&nbsp;II</a>
						</li>
					<li>
				<a href="http://akrzemi1.wordpress.com/2012/09/30/why-make-your-classes-final/" title="Why make your classes&nbsp;final?">Why make your classes&nbsp;final?</a>
						</li>
					<li>
				<a href="http://akrzemi1.wordpress.com/2012/08/12/user-defined-literals-part-i/" title="User-defined literals — Part&nbsp;I">User-defined literals — Part&nbsp;I</a>
						</li>
					<li>
				<a href="http://akrzemi1.wordpress.com/2012/07/12/quality-matters/" title="Quality&nbsp;Matters">Quality&nbsp;Matters</a>
						</li>
				</ul>
		</li><li id="archives-2" class="widget-container widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href="http://akrzemi1.wordpress.com/2012/10/" title="October 2012">October 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/09/" title="September 2012">September 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/08/" title="August 2012">August 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/07/" title="July 2012">July 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/06/" title="June 2012">June 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/05/" title="May 2012">May 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/04/" title="April 2012">April 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/03/" title="March 2012">March 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/02/" title="February 2012">February 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2012/01/" title="January 2012">January 2012</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/12/" title="December 2011">December 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/11/" title="November 2011">November 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/10/" title="October 2011">October 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/09/" title="September 2011">September 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/08/" title="August 2011">August 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/07/" title="July 2011">July 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/06/" title="June 2011">June 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/05/" title="May 2011">May 2011</a></li>
	<li><a href="http://akrzemi1.wordpress.com/2011/04/" title="April 2011">April 2011</a></li>
		</ul>
</li><li id="categories-2" class="widget-container widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
			<li class="cat-item cat-item-196"><a href="http://akrzemi1.wordpress.com/category/programming/" title="as the name implies...">programming</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://akrzemi1.wordpress.com/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
		</ul>
</li>			</ul>
		</div><!-- #primary .widget-area -->


		<div id="secondary" class="widget-area" role="complementary">
			<ul class="xoxo">
				<li id="linkcat-1356" class="widget-container widget_links"><h3 class="widget-title">Blogroll</h3>
	<ul class="xoxo blogroll">
<li><a href="http://www.justsoftwaresolutions.co.uk/blog/" title="Anthony Williams’s blog on multithreading in C++11">Anthony Williams's blog</a></li>
<li><a href="http://bartoszmilewski.wordpress.com/" title="Bartosz Milewski’s Programming Cafe">Bartosz Milewski's Cafe</a></li>
<li><a href="http://www.codesynthesis.com/%7Eboris/blog/">Boris Kolpackov</a></li>
<li><a href="http://cpptruths.blogspot.com/">C++ Truths</a></li>
<li><a href="http://cpp-next.com/">C++Next</a></li>
<li><a href="http://blog.corensic.com/">Corensic</a></li>
<li><a href="http://mortoray.wordpress.com/">Musing Dragoman</a></li>
<li><a href="http://herbsutter.com/">Sutter’s Mill</a></li>
<li><a href="http://definedbehavior.blogspot.com/" title="[Un]defined behavior">[Un]defined behavior</a></li>

	</ul>
</li>
<li id="linkcat-168780" class="widget-container widget_links"><h3 class="widget-title">C++ Links</h3>
	<ul class="xoxo blogroll">
<li><a href="http://www2.research.att.com/%7Ebs/homepage.html">Bjarne Stroustrup's homepage</a></li>
<li><a href="http://www.boost.org/">Boost's homepage</a></li>
<li><a href="http://cppannotations.sourceforge.net/cppannotations/html/">C++ Annotations</a></li>
<li><a href="http://cplusplus.github.com/LWG/" title="C++ Standards Committee Library Working Group">C++ Standards Committee — LWG</a></li>
<li><a href="http://fpcomplete.com/blog/">FPComplete</a></li>
<li><a href="http://www.gotw.ca/gotw/">Guru Of The week</a></li>
<li><a href="http://home.roadrunner.com/%7Ehinnant/">Howard Hinnant's page</a></li>
<li><a href="https://groups.google.com/a/isocpp.org/forum/#%21forum/std-discussion">ISO C++ Standard – Discussion</a></li>
<li><a href="https://groups.google.com/a/isocpp.org/forum/#%21forum/std-proposals">ISO C++ Standard – Future Proposals</a></li>
<li><a href="http://www.synesis.com.au/publications.html">Matthew Wilson's work</a></li>
<li><a href="http://www.isocpp.org/">Standard C++ Foundation</a></li>
<li><a href="http://www.sgi.com/tech/stl/">STL Programmer's Guide</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/">The C++ Standards Committee</a></li>
<li><a href="http://en.wikipedia.org/wiki/C%2B%2B11">Wikipedia on C++11</a></li>

	</ul>
</li>
			</ul>
		</div><!-- #secondary .widget-area -->

	</div><!-- #main -->

	<div id="footer" role="contentinfo">
		<div id="colophon">



			<div id="site-info">
				<a href="http://akrzemi1.wordpress.com/" title="Andrzej's C++ blog" rel="home">
					Andrzej's C++ blog				</a>
			</div><!-- #site-info -->

			<div id="site-generator">
				Theme: <a href="http://theme.wordpress.com/themes/twentyten/" title="Learn more about this theme">Twenty Ten</a>				<a href="http://wordpress.com/?ref=footer" rel="generator">Blog at WordPress.com</a>.
			</div><!-- #site-generator -->

		</div><!-- #colophon -->
	</div><!-- #footer -->

</div><!-- #wrapper -->


<script type="text/javascript">
var _qevents = _qevents || [], wpcomQuantcastData = {"qacct":"p-18-mFEk4J448M","labels":",language.en,type.wpcom,posttag.c11,posttag.correctness,as"};
function wpcomQuantcastPixel( labels, options ) {
	var i, defaults = wpcomQuantcastData, data = { event: 'ajax' };

	labels  = labels  || '';
	options = options || {};

	if ( typeof labels != 'string' )
		options = labels;

	for ( i in defaults ) {
		data[i] = defaults[i];
	}

	for ( i in options ) {
		data[i] = options[i];
	}

	if ( data.labels ) {
		data.labels += ',' + labels;
	} else {
		data.labels = labels;
	}

	_qevents.push( data );
};
(function() {var elem = document.createElement('script');elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge") + ".quantserve.com/quant.js";elem.async = true;elem.type = "text/javascript";var scpt = document.getElementsByTagName('script')[0];scpt.parentNode.insertBefore(elem, scpt);  })();
_qevents.push( wpcomQuantcastData );
</script>
<noscript><div style="display: none;"><img src="//pixel.quantserve.com/pixel/p-18-mFEk4J448M.gif?labels=%2Clanguage.en%2Ctype.wpcom%2Cposttag.c11%2Cposttag.correctness%2Cas" height="1" width="1" alt="" /></div></noscript>


	<script type="text/javascript">
	/* <![CDATA[ */
	(function($){
		$(document).on( 'ready post-load', function() {

			// Remove the login box when clicking the page
			$( document ).mousedown( function( e ) {
				if ( null == $( e.target ).closest( '#wpl-mustlogin' ).get( 0 ) ) {
					$( '#wpl-mustlogin' ).remove();
				}
			});

			// Handle clicking the like button itself
			$('.wpl-button > a.like').click( function(e) {
				e.preventDefault();

				var postid = $(this).parent().attr('id').split('like-')[1];
				$.post( 'http://akrzemi1.wordpress.com/wp-admin/admin-ajax.php', {
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_like_click'
				} );

				var tenMins = new Date();
				tenMins.setTime( tenMins.getTime() + 600000 );
				document.cookie = 'wpl_rand=fe22c01896; expires=' + tenMins.toGMTString() + '; domain=wordpress.com; path=/;';

				$(this).parent().siblings('.wpl-count').after( '\
					<div id="wpl-mustlogin"> \
						<form action="https://akrzemi1.wordpress.com/wp-login.php" method="post"> \
							<p>Just one more step to like this:</p> \
							<label><span>Username</span> <input type="text" name="log" id="user_login" class="input" value="" size="20" tabindex="80" /></label> \
							<label><span>Password</span> <input type="password" name="pwd" id="user_pass" class="input" value="" size="20" tabindex="81" /></label> \
							<input type="submit" name="wp-submit" id="wp-submit" class="button-primary" value="Log In" tabindex="82" /> \
							<input type="hidden" name="postid" value="' + postid + '" /> \
							<input type="hidden" name="redirect_to" value="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization?year=2012&#038;monthnum=05&#038;day=27&#038;name=constant-initialization&#038;like=1" /> \
							<input type="hidden" name="wpl_rand" value="fe22c01896" /> \
							<p>Not a member yet? <a href="http://wordpress.com/signup/?ref=likebox&user=1" id="wpl-signup-link">Sign up with WordPress.com for free</a></p> \
						</form> \
					</div> \
				');

				$('#wpl-mustlogin').hide().slideDown('fast');
			} );

			$('#wpl-mustlogin input.input').live( 'focus', function() {
				$(this).prev().hide();
			}).live( 'blur', function() {
				if ( $(this).val() == '' ) {
					$(this).prev().show();
				}
			});

			$('#wpl-mustlogin input#wp-submit').live( 'click', function(e) {
				e.preventDefault();

				$.post( 'http://akrzemi1.wordpress.com/wp-admin/admin-ajax.php', {
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_login_submit'
				}, function() {
					$('#wpl-mustlogin form').submit();
				} );
			});

			$('#wpl-mustlogin a#wpl-signup-link').live( 'click', function(e) {
				e.preventDefault();

				var link = $(this).attr('href');

				$.post( 'http://akrzemi1.wordpress.com/wp-admin/admin-ajax.php', {
					'action': 'wpl_record_stat',
					'stat_name': 'loggedout_signup_click'
				}, function() {
					location.href = link;
				} );
			});
		})
	})(jQuery);
	/* ]]> */
	</script>
<script type="text/javascript" src="sampleWordPressPage2_files/gprofiles.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="sampleWordPressPage2_files/wpgroho.js"></script>
<script>jQuery(document).ready(function($){ Gravatar.profile_cb = function( h, d ) { WPGroHo.syncProfileData( h, d );	}; Gravatar.my_hash = WPGroHo.my_hash; Gravatar.init( 'body', '#wp-admin-bar-my-account' ); });</script>	<div style="display:none">
	<div class="grofile-hash-map-37e370fb4e87500805abb44c8820ec1f">
	</div>
	<div class="grofile-hash-map-c3baf4aa5bebf6d1407ed4e3b0981864">
	</div>
	<div class="grofile-hash-map-6434613b3d4e3582411be9be25d8b80f">
	</div>
	<div class="grofile-hash-map-2d24277226f4c86d39c2b63c3ea590dc">
	</div>
	<div class="grofile-hash-map-05aa36ab5c7d2c620d27d86415ba2eb7">
	</div>
	</div>
<script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"http:\/\/akrzemi1.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"http:\/\/akrzemi1.wordpress.com\/wp-login.php?action=logout&_wpnonce=9a7e181596","homeURL":"http:\/\/akrzemi1.wordpress.com\/","postID":"3030","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0"};
/* ]]> */
</script>
<script type="text/javascript" src="sampleWordPressPage2_files/script.js"></script>

	<div style="bottom: -264px;" id="bit" class="loggedout-follow-normal">
		<a class="bsub" href="javascript:void(0)"><span id="bsub-text">Follow</span></a>
		<div id="bitsubscribe">

					<h3><label for="loggedout-follow-field">Follow “Andrzej's C++ blog”</label></h3>

			<form action="https://subscribe.wordpress.com" method="post" accept-charset="utf-8" id="loggedout-follow">
			<p>Get every new post delivered to your Inbox.</p>

			<p id="loggedout-follow-error" style="display: none;"></p>

						<p class="bit-follow-count">Join 51 other followers</p>
			<p><input name="email" style="width: 95%; padding: 1px 2px" value="Enter your email address" onfocus='this.value=(this.value=="Enter your email address") ? "" : this.value;' onblur='this.value=(this.value=="") ? "Enter email address" : this.value;' id="loggedout-follow-field" type="email"></p>

			<input name="action" value="subscribe" type="hidden">
			<input name="blog_id" value="21765996" type="hidden">
			<input name="source" value="http://akrzemi1.wordpress.com/2012/05/27/constant-initialization/" type="hidden">
			<input name="sub-type" value="loggedout-follow" type="hidden">

			<input id="_wpnonce" name="_wpnonce" value="5e3fbac1cf" type="hidden"><input name="_wp_http_referer" value="/2012/05/27/constant-initialization/" type="hidden">
			<p id="bsub-subscribe-button"><input value="Sign me up" type="submit"></p>
			</form>
					<div id="bsub-credit"><a href="http://wordpress.com/signup/?ref=lof">Powered by WordPress.com</a></div>
		</div><!-- #bitsubscribe -->
	</div><!-- #bit -->
<script type="text/javascript" charset="UTF-8" id="polldaddyRatings"><!--//--><![CDATA[//><!--
PDRTJS_settings_4527172_post_3030={"id":4527172,"unique_id":"wp-post-3030","title":"Constant%26nbsp%3Binitialization","permalink":"http:\/\/akrzemi1.wordpress.com\/2012\/05\/27\/constant-initialization\/","item_id":"_post_3030"}; if ( typeof PDRTJS_RATING !== 'undefined' ){if ( typeof PDRTJS_4527172_post_3030 == 'undefined' ){PDRTJS_4527172_post_3030 = new PDRTJS_RATING( PDRTJS_settings_4527172_post_3030 );}}
//--><!]]></script><script type="text/javascript" charset="UTF-8" src="sampleWordPressPage2_files/rating.js"></script><script type="text/javascript" src="sampleWordPressPage2_files/beacon.js"></script><script type="text/javascript">try{COMSCORE.beacon({c1:2,c2:7518284});}catch(e){}</script><noscript><p class="robots-nocontent"><img src="http://b.scorecardresearch.com/p?cj=1c1=2&#038;c2=7518284" alt="" style="display:none" width="1" height="1" /></p></noscript><script type="text/javascript" src="sampleWordPressPage2_files/a.js"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var themecssurl = "http://s0.wp.com/wp-content/plugins/syntaxhighlighter-wpcom/shThemeDefault.css?m=1267535107g&amp;ver=2.1.364b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		document.getElementsByTagName("head")[0].appendChild(themecss);
	})();
	SyntaxHighlighter.config.clipboardSwf = 'http://s2.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter/scripts/clipboard.swf?m=1309109436g';
	SyntaxHighlighter.config.strings.expandSource = 'show source';
	SyntaxHighlighter.config.strings.viewSource = 'view source';
	SyntaxHighlighter.config.strings.copyToClipboard = 'copy to clipboard';
	SyntaxHighlighter.config.strings.copyToClipboardConfirmation = 'The code is in your clipboard now';
	SyntaxHighlighter.config.strings.print = 'print';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.all();
</script>
<script type="text/javascript">
/* <![CDATA[ */
var thickboxL10n = {"next":"Next >","prev":"< Prev","image":"Image","of":"of","close":"Close","noiframes":"This feature requires inline frames. You have iframes disabled or your browser does not support them.","loadingAnimation":"http:\/\/akrzemi1.wordpress.com\/wp-includes\/js\/thickbox\/loadingAnimation.gif","closeImage":"http:\/\/akrzemi1.wordpress.com\/wp-includes\/js\/thickbox\/tb-close.png"};
var thickboxL10n = {"next":"Next >","prev":"< Prev","image":"Image","of":"of","close":"Close","noiframes":"This feature requires inline frames. You have iframes disabled or your browser does not support them.","loadingAnimation":"http:\/\/akrzemi1.wordpress.com\/wp-includes\/js\/thickbox\/loadingAnimation.gif","closeImage":"http:\/\/akrzemi1.wordpress.com\/wp-includes\/js\/thickbox\/tb-close.png"};
/* ]]> */
</script>
<script type="text/javascript" src="sampleWordPressPage2_files/a_003.js"></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script><script src="sampleWordPressPage2_files/w.js" type="text/javascript"></script>
<script type="text/javascript">
st_go({'blog':'21765996','v':'wpcom','user_id':'0','post':'3030','subd':'akrzemi1'});
ex_go({'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWtpP0NsWnVkPS9sL0ViLndld3AlTlV5ST9WY3J1RWNQW0Zycy1kaXRqWmJuPVdobHk/MkNULW5POGlyMV1+alFaSDZyTTI5TDVtODFSUTk9Qlp+aWZBXX41YnR5RT9DdVduYVc2SEQ/d0JEbmZXQW1iZW89RFVdPU58cGRRNlEsZmNJRVBXZm5ncTl+LGgybkE/Zkt+L20tNW1sZisvJWpwS3RJLDRiW2NCRDArUiZfMVRjdjFGfEYlejNuUC9hSExIOWdRQX5lMXNMc0xDT2RfTE5QdVpGV1g0ckc3Q0IwS3dXaFtVW3NwfGtXNT9wQl0mZT03blthZnZ1VUktTS0xTmFwW0c='});
addLoadEvent(function(){linktracker_init('21765996',3030);});
	</script><img id="wpstats" src="sampleWordPressPage2_files/g_002.gif" alt=""><img id="wpstats2" src="sampleWordPressPage2_files/g.gif" alt="" style="display:none">
<noscript><img src="http://stats.wordpress.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>


</body></html>